!function t(e,r,a){function o(s,i){if(!r[s]){if(!e[s]){var c="function"==typeof require&&require;if(!i&&c)return c(s,!0);if(n)return n(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[s]={exports:{}};e[s][0].call(d.exports,function(t){var r=e[s][1][t];return o(r?r:t)},d,d.exports,t,e,r,a)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(t,e,r){e.exports.mode="undefined",e.exports.addLine=function(t,r,a,o){var n=d3.select("#graph").append("path").attr("class","line");if("linear"==e.exports.mode||"undefined"==e.exports.mode)n.attr("d",e.exports.linear(a,o));else{d3.svg.line().x(accessor_scaled_x).y(accessor_scaled_y).interpolate(e.exports.mode)}},e.exports.linear=function(t,e){for(var r="",a="Weighted Price",o=0;o<t.length;o++){var n=e(t[o],a);r+=0!==o?"L"+n[0]+","+n[1]:"M"+n[0]+","+n[1],o!==t.length-1&&(r+=" ")}return r},e.exports.update=function(t,r,a,o){for(var n=0;n<a.length;n++)if("linear"==e.exports.mode||"undefined"==e.exports.mode)d3.select(".line").attr("d",e.exports.linear(t,o));else{var s=d3.svg.line().x(r.accessor_scaled).y(a[n].accessor_scaled).interpolate(e.exports.mode);d3.select(".line").attr("d",s(t))}}},{}],2:[function(t,e,r){e.exports.min=function(t,e){return d3.min(t,e)},e.exports.max=function(t,e){return d3.max(t,e)},e.exports.minMultipleSets=function(t,e){for(var r,a=0;a<e.length;a++){var o=d3.min(t,e[a].accessor);(!r||r>o)&&(r=o)}return r},e.exports.maxMultipleSets=function(t,e){for(var r,a=0;a<e.length;a++){var o=d3.max(t,e[a].accessor);(!r||o>r)&&(r=o)}return r},e.exports.applyOverflow=function(t,e,r,a){return"Date"==a?new Date(t.getTime()+(e.getTime()-t.getTime())*r):"Number"==a?t+(e-t)*r:void 0}},{}],3:[function(t,e,r){e.exports=function(t,e){return t.sort(function(t,r){return e.accessor(t)<e.accessor(r)?-1:e.accessor(t)>e.accessor(r)?1:0}),t}},{}],4:[function(t,e,r){console.log("Tooltip"),e.exports.opt={},e.exports.nextIndex=function(t,e,r){for(var a=-1,o=0;o<t.length-1;o++){var n=e(t[o]),s=e(t[o+1]),i=r>=n,c=s>=r;i&&c&&(Δ1=Math.abs(e(t[o])-r),Δ2=Math.abs(e(t[o+1])-r),a=Δ1<Δ2?o:o+1)}return a},e.exports.tooltip=function(t,e,r,a,o){var n=d3.select("#tooltip");if(n.empty()){n=a.append("g").attr("id","tooltip").attr("class","tooltip"),n.append("circle").attr("id","tooltip-circle");var s=n.append("g").attr("id","label");s.append("text").attr("text-anchor","middle").attr("id","label-text")}if(-1==r)return void n.attr("visibility","hidden");n.attr("visibility","visible"),d3.select("#label-text").text(o(t[r])).attr("x",0).attr("y",-10);var i=e(t[r]);n.attr("transform","translate("+i[0]+","+i[1]+")")},e.exports.updateTooltip=function(t,r,a,o,n){var s=[];s[0]=e.exports.mouse[0]-e.exports.opt.graphTransform.xstart,s[1]=e.exports.mouse[1]-e.exports.opt.graphTransform.ytop;for(var i=r.invert(s[0]),c=0;c<n.length;c++){var l=e.exports.nextIndex(t,o.accessor,i);e.exports.tooltip(t,function(t){return[o.accessor_scaled(t),n[c].accessor_scaled(t)]},l,d3.select("#graph"),function(t){return Math.round(1e3*n[c].accessor(t))/1e3})}}},{}],5:[function(t,e,r){function a(){d3.csv("data.csv",function(t,e){function r(){D.call(f),N.call(x);for(var t=0;t<s.length;t++)M.selectAll("circle.data-point").attr("cx",n.accessor_scaled).attr("cy",s[t].accessor_scaled);v.updateTooltip(e,i,c,n,s),h.update(e,n,s,m)}e=g(e,n);for(var a=0;a<e.length;a++)for(var u=0;u<o.length;u++)"Number"==o[u].data_type?e[a][o[u].row]=parseFloat(e[a][o[u].row]):"Date"==o[u].data_type&&(e[a][o[u].row]=d3.time.format(o[u].date_format).parse(e[a][o[u].row]));var _=[],b=[];_[0]=y.min(e,n.accessor),_[1]=y.max(e,n.accessor),b[0]=y.minMultipleSets(e,s),b[1]=y.maxMultipleSets(e,s),_[1]=y.applyOverflow(_[0],_[1],1.1,n.data_type),b[1]=y.applyOverflow(b[0],b[1],1.1,s[0].data_type),i.domain(_),c.domain(b);var w=d3.behavior.zoom().x(i).y(c).scaleExtent([1,50]).on("zoom",r),T=null,M=d3.select("#visualization").attr("width",l).attr("height",d).call(w);M.append("mask").attr("id","mask").append("rect").attr("x",0).attr("y",0).attr("width",l-p.xstart-p.xend).attr("height",d-p.ytop-p.ybottom).attr("fill","white"),T=M.append("g").attr("id","graph").attr("transform","translate("+p.xstart+","+p.ytop+")").attr("mask","url(#mask)");for(var k=T.selectAll("circle").data(e).enter(),a=0;a<s.length;a++)k.append("circle").attr("class","data-point").attr("cx",n.accessor_scaled).attr("cy",s[a].accessor_scaled);var D=M.append("g").attr("class","axis axis-x").attr("transform","translate("+p.xstart+","+(d-p.ybottom)+")").call(f),N=M.append("g").attr("class","axis axis-y").attr("transform","translate(50,0)").call(x);M.append("rect").attr("id","overlay").attr("x",p.xstart).attr("y",p.ytop).attr("width",l-p.xstart-p.xend).attr("height",d-p.ytop-p.ybottom).on("mousemove",function(){v.mouse=d3.mouse(this),v.updateTooltip(e,i,c,n,s)});for(var a=0;a<s.length;a++)h.addLine(n,s[a],e,m);$("select").on("change",function(){h.mode=this.value,h.update(e,n,s,m)}),$("#checkbox").on("change",function(){var t=d3.selectAll(".data-point");$(this).is(":checked")?t.classed("hidden",!1):t.classed("hidden",!0)})})}var o,n,s,i,c,l,d,p,u,f,x,m,v=t("./modules/tooltip"),h=t("./modules/line"),g=t("./modules/sort"),y=t("./modules/range");d3.json("meta.json",function(t,e){if(t)return console.log(t),void alert(t);o=e,console.log(o),n={},s=[];for(var r=0;r<o.length;r++)"index"==o[r].type?n=o[r]:"value"==o[r].type&&s.push(o[r]);"Number"==n.data_type?i=d3.scale.linear():"Date"==n.data_type&&(i=d3.time.scale()),"Number"==s[0].data_type?c=d3.scale.linear():"Date"==s[0].data_type&&(c=d3.time.scale()),l=1e3,d=600,p={xstart:50,ytop:0,xend:0,ybottom:50},v.opt.graphTransform=p,u=[],i.range([0,l-p.xstart-p.xend]),c.range([d-p.ytop-p.ybottom,0]),f=d3.svg.axis().scale(i).orient("bottom").ticks(5),x=d3.svg.axis().scale(c).orient("left").ticks(5),n.accessor=function(t){return t[n.row]},n.accessor_scaled=function(t){return i(t[n.row])};for(var r=0;r<s.length;r++){var h=s[r].row;s[r].accessor=function(t){return t[h]},s[r].accessor_scaled=function(t){return c(t[h])}}m=function(t,e){return[n.accessor_scaled(t),c(t[e])]},a()})},{"./modules/line":1,"./modules/range":2,"./modules/sort":3,"./modules/tooltip":4}]},{},[5]);
//# sourceMappingURL=script.js.map
