!function t(r,e,n){function a(i,u){if(!e[i]){if(!r[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var d=e[i]={exports:{}};r[i][0].call(d.exports,function(t){var e=r[i][1][t];return a(e?e:t)},d,d.exports,t,r,e,n)}return e[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(t,r,e){var n=t("./range");r.exports.overflowX=function(t,r,e){var a=[];return a[0]=n.min(t,r.accessor),a[1]=n.max(t,r.accessor),a[1]=n.applyOverflow(a[0],a[1],e,r.data_type),a},r.exports.overflowY=function(t,r,e,a){var o=[];return o[0]=n.minMultipleSets(t,r,e),o[1]=n.maxMultipleSets(t,r,e),o[1]=n.applyOverflow(o[0],o[1],a,r[0].data_type),o}},{"./range":5}],2:[function(t,r,e){r.exports.row=function(t,r){for(var e=[],n=0;n<t.length;n++)"undefined"!=typeof t[n][r]&&e.push(t[n]);return e}},{}],3:[function(t,r,e){var n=(t("./sort"),t("./id"));r.exports.data_types=function(t,r){for(var e=0;e<t.length;e++)for(var n=0;n<r.length;n++)"Number"===r[n].data_type?t[e][r[n].row]=parseFloat(t[e][r[n].row]):"Date"===r[n].data_type&&(t[e][r[n].row]=d3.time.format(r[n].date_format).parse(t[e][r[n].row]));return t},r.exports.ids=function(t,r){for(var e=0;e<t.length;e++)for(var a=0;a<r.length;a++)"index"!==r[a].type&&(t[e][n.get(r[a])]=t[e][r[a].row],delete t[e][r[a].row]);return t}},{"./id":4,"./sort":6}],4:[function(t,r,e){r.exports.get=function(t){return t.row+"#"+t.url},r.exports.invert=function(t,r){for(var e=0;e<r.length;e++)if(t===r[e].rowId)return r[e]},r.exports.raw=function(t,r){return t+"#"+r}},{}],5:[function(t,r,e){r.exports.min=function(t,r){return d3.min(t,r)},r.exports.max=function(t,r){return d3.max(t,r)},r.exports.minMultipleSets=function(t,r,e){for(var n,a=0;a<r.length;a++)if(r[a].activated){var o=d3.min(t,e.raw(r[a]));"undefined"!=typeof o&&("undefined"==typeof n||n>o)&&(n=o)}return n},r.exports.maxMultipleSets=function(t,r,e){for(var n,a=0;a<r.length;a++)if(r[a].activated){var o=d3.max(t,e.raw(r[a]));("undefined"==typeof n||o>n)&&(n=o)}return n},r.exports.applyOverflow=function(t,r,e,n){return"Date"===n?new Date(t.getTime()+(r.getTime()-t.getTime())*e):"Number"===n?t+(r-t)*e:void 0}},{}],6:[function(t,r,e){r.exports=function(t,r){return t.sort(function(t,e){return r.accessor(t)<r.accessor(e)?-1:r.accessor(t)>r.accessor(e)?1:0}),t}},{}],7:[function(t,r,e){function n(){function t(t){return function(n,o){if(n)return alert(n),void console.log(n);o=_.data_types(o,i[t].config),o=_.ids(o,i[t].config);for(var s=0;s<o.length;s++)e.push(o[s]);++r===i.length&&(e=y(e,u),a(e))}}for(var r=0,e=[],n=0;n<i.length;n++)d3.csv(i[n].url,t(n))}function a(t){function r(t){var r=t.split(",")[0],e=t.split(",")[1];return r=parseInt(r,10),e=parseInt(e,10),0===r?u.accessor:c.raw(s[r-1])}function e(t){var r=t.split(",")[0],e=t.split(",")[1];return r=parseInt(r,10),e=parseInt(e,10),0===e?u.accessor:c.raw(s[e-1])}function n(r){var e=r.split(",")[0];e=parseInt(e,10);var n;if(0===e)n=p;else{"Number"===s[e-1].data_type?n=d3.scale.linear():"Date"===s[e-1].data_type&&(n=d3.time.scale());var a=[];a[0]=O.min(t,c.raw(s[e-1])),a[1]=O.max(t,c.raw(s[e-1])),a[1]=O.applyOverflow(a[0],a[1],1.1,s[e-1].data_type),n.domain(a)}return n.range([0,w]),n}function a(r){var e=r.split(",")[1];e=parseInt(e,10);var n;if(0===e)n=p;else{"Number"===s[e-1].data_type?n=d3.scale.linear():"Date"===s[e-1].data_type&&(n=d3.time.scale());var a=[];a[0]=O.min(t,c.raw(s[e-1])),a[1]=O.max(t,c.raw(s[e-1])),a[1]=O.applyOverflow(a[0],a[1],1.1,s[e-1].data_type),n.domain(a)}return n.range([h,0]),n}function o(t,r,e){d.append("rect").attr("x",r*w).attr("y",t*h).attr("width",w).attr("height",h).classed("label",!0),d.append("text").classed("label-text",!0).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("x",r*w+.5*w).attr("y",t*h+.5*h).html(e)}function i(t,r,e){var n=r*w,a=t*h;l(n,a,e,t+"-"+r)}function l(t,o,i,u){var s=d.append("g").attr("id",u).attr("transform","translate("+t+","+o+")");s.append("rect").attr("class","tile").attr("width",w).attr("height",h);var l=s.selectAll("circle").data(i.data).enter();l.append("circle").attr("class","data-point").attr("cx",function(t){var e=n(i.id),a=r(i.id);return e(a(t))}).attr("cy",function(t){var r=a(i.id),n=e(i.id);return r(n(t))})}var d=d3.select("#visualization").attr("width",m).attr("height",g),f=s.length+1;w=m/f,h=g/f,p.domain(N.overflowX(t,u,1.1));for(var v,y=0;y<s.length;y++)v||(v=I.row(t,s[y].rowId).length),v!==I.row(t,s[y].rowId).length&&alert("datasets mismatch");for(var x=[],y=0;f>y;y++)for(var _=0;f>_;_++)if(y!==_){var b,D=[],S=[];0===y?b=u:(b=s[y-1],S=I.row(t,s[y-1].rowId));var M;if(0===_)M=u,D=S;else{M=s[_-1];var q=[];q=I.row(t,s[_-1].rowId);var T=JSON.parse(JSON.stringify(S));if(0!==T.length){for(var C=0;C<q.length;C++)T[C][s[_-1].rowId]=e(y+","+_)(q[C]);D=T,S=void 0}else D=q}var j={xConfig:b,yConfig:M,data:D,id:y+","+_};x.push(j)}for(var E=0,y=0;f>y;y++)for(var _=0;f>_;_++)if(y!==_)i(y,_,x[E++]);else{var F;F=0===y?(u.name?u.name:u.row)+(u.unit?" in "+u.unit:""):(s[y-1].name?s[y-1].name:s[y-1].row)+(s[y-1].unit?" in "+s[y-1].unit:""),o(y,_,F)}}var o,i,u,s,l,d,f,c,p,v,m,g,w,h,y=t("./modules/sort"),x=t("./modules/id"),_=t("./modules/format"),I=t("./modules/filter"),N=t("./modules/domain"),O=t("./modules/range");d3.json("meta.json",function(t,r){if(t)return console.log(t),void alert(t);o=[],i=r.datasets,u={},s=[];for(var e=d3.scale.category20(),a=0;a<i.length;a++)for(var y=i[a],_=y.url,I=0;I<y.config.length;I++){var N=y.config[I];N.url=_,N.rowId=x.get(N),o.push(N),"index"===N.type?u=N:"value"===N.type&&(N.color=e(s.length+1),"undefined"==typeof N.activated&&(N.activated=!0),s.push(N))}"Number"===u.data_type?p=d3.scale.linear():"Date"===u.data_type&&(p=d3.time.scale()),"Number"===s[0].data_type?v=d3.scale.linear():"Date"===s[0].data_type&&(v=d3.time.scale()),m=1100,g=550,w=200,h=200,p.range([0,w]),v.range([h,0]),u.accessor=function(t){return t[u.row]},u.accessor_scaled=function(t){return p(t[u.row])},l=function(t){return function(r){return r[t.rowId]}},d=function(t){return function(r){return v(r[t.rowId])}},f=function(t,r){return function(e){return[t.accessor_scaled(e),d(r)(e)]}},c={raw:l,scaled:d,cord:f},n()})},{"./modules/domain":1,"./modules/filter":2,"./modules/format":3,"./modules/id":4,"./modules/range":5,"./modules/sort":6}]},{},[7]);
//# sourceMappingURL=script.js.map
